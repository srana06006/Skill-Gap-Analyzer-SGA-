document.getElementById('li-form').addEventListener('submit', async (e)=>{e.preventDefault(); const r = await fetch(`/api/live_intelligence?title=${encodeURIComponent(document.getElementById('title').value)}&loc=${encodeURIComponent(document.getElementById('loc').value)}`); const d = await r.json(); const sf=document.getElementById('skill_freq'); sf.innerHTML=''; (d.top_skill_freq||[]).forEach(x=>{const li=document.createElement('li'); li.textContent = `${x.skill} — ${x.count}`; sf.appendChild(li);}); const jobs=document.getElementById('jobs'); jobs.innerHTML=''; (d.jobs||[]).slice(0,10).forEach(j=>{const li=document.createElement('li'); li.innerHTML = `<strong>${j.title}</strong> — ${j.company}<br><a href='${j.link||'#'}' target='_blank'>apply</a>`; jobs.appendChild(li);});}); window.addEventListener('load',()=>document.getElementById('li-form').dispatchEvent(new Event('submit')));